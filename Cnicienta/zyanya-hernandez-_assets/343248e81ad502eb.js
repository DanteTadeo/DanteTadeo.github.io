(globalThis["webpackChunk_canva_web"] = globalThis["webpackChunk_canva_web"] || []).push([[5936],{

/***/ 529453:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);globalThis._5f74ec40302898c5a55451c9fbd04240 = globalThis._5f74ec40302898c5a55451c9fbd04240 || {};(function(__c) {var EC=__c.EC;var oc=__c.oc;var Eg=__c.Eg;var jn=__c.jn;var L=__c.L;var DC=__c.DC;var Yu=__c.Yu;var A=__c.A;var J=__c.J;var Km=__c.Km;var z=__c.z;
var WGc=function(a,b,c,d,e){const f=[];for(const l of d)for(const m of e){d=l.ka;var g=m.column,h=a.layout.cells.get(d,g);if(!h||(l.boundary==="start"?h.span.fc===d:h.span.jd===d))if(d=c.get(`${g.id}:${d.id}`),d=l.boundary==="start"?d?.ma:d?.Aa){h=f[f.length-1];g=(g=b.next(g))?{column:g,boundary:"start"}:{column:z(b.last()),boundary:"end"};var k;if(k=h)k=h.iCa,k=k.column===m.column&&k.boundary===m.boundary;k&&(k=h.$bb,k=k.ka===l.ka&&k.boundary===l.boundary);k&&h.color===d.color&&h.weight===d.weight&&
h.Gd===d.Gd&&h.Gd===0?h.iCa=g:f.push({$bb:l,BPb:m,iCa:g,color:d.color,weight:d.weight,Gd:d.Gd})}}return f},XGc=function(a,b,c,d,e,f){const g=[];for(const m of e)for(const n of d){var h=n.ka,k=m.column;e=a.layout.cells.get(h,k);if(!e||(m.boundary==="start"?e.span.sc===k:e.span.ud===k))if(e=c.get(`${k.id}:${h.id}`),(e=m.boundary==="start"?e?.qa:e?.Oa)&&(m.boundary!=="start"||f(h,k)!==1)){k=g[g.length-1];h=(h=b.next(h))?{ka:h,boundary:"start"}:{ka:z(b.last()),boundary:"end"};var l;if(l=k)l=k.oWa,l=l.column===
m.column&&l.boundary===m.boundary;l&&(l=k.oCa,l=l.ka===n.ka&&l.boundary===n.boundary);l&&k.color===e.color&&k.weight===e.weight&&k.Gd===e.Gd&&k.Gd===0?k.oCa=h:g.push({oWa:m,RPb:n,oCa:h,color:e.color,weight:e.weight,Gd:e.Gd})}}return g},YGc=function(a,b,c,d,e,f){const g=a.Deb.jsb(d,b.last(),c.last());a=(r,t)=>{const v=g.get(r)||0,w=g.get(t)||0;return v<=w?r:t};const h=new Map;if(e.length===0||f.length===0)return h;var k=[],l=c.previous(f[0].column);l&&k.push({column:l,boundary:"start"});k.push(...f);
(f=c.next(f[f.length-1].column))&&k.push({column:f,boundary:"start"});f=[];(l=b.previous(e[0].ka))&&f.push({ka:l,boundary:"start"});f.push(...e);(e=b.next(e[e.length-1].ka))&&f.push({ka:e,boundary:"start"});for(const r of k){k=(e=r.boundary==="start"?r.column:void 0)?c.previous(e):c.last();for(const t of f){var m=t.boundary==="start"?t.ka:void 0;l=m?b.previous(m):b.last();var n=e&&m&&d.get(`${e.id}:${m.id}`),p=e&&l&&d.get(`${e.id}:${l.id}`);m=k&&m&&d.get(`${k.id}:${m.id}`);var q=k&&l&&d.get(`${k.id}:${l.id}`);
l=r.boundary==="end"?m?.Oa:n?.qa;n=t.boundary==="end"?p?.Aa:n?.ma;p=r.boundary==="end"?q?.Oa:p?.qa;m=t.boundary==="end"?q?.Aa:m?.ma;q=__c.mla({ma:p,Aa:l,qa:m,Oa:n},a);let v;switch(q){case "blockStart":v=p;break;case "blockEnd":v=l;break;case "inlineStart":v=m;break;case "inlineEnd":v=n;break;default:v=void 0}const {height:w,width:x}=v?.Gd===1?{height:v.weight,width:v.weight}:{height:Math.max(m?.weight||0,n?.weight||0),width:Math.max(p?.weight||0,l?.weight||0)};h.set(c6(r,t),__c.zm(q,w/2,x/2))}}return h},
ZGc=function(a,b,c,d,e,f,g,h){if(f.length===0||g.length===0)return[];const k=WGc(b,d,e,f,g);h=XGc(b,c,e,f,g,h);const l=YGc(a,c,d,e,f,g),m=a.kzb(c),n=a.yyb(b,d),p=b.direction==="rtl";a=k.map(q=>{var r=q.BPb,t=q.iCa,v=q.$bb;const w=q.color,x=q.weight;q=q.Gd;const B=p?-1:1,C=l.get(c6(r,v))?.Oa,D=l.get(c6(t,v))?.qa;if(C!=null&&D!=null){var E=z(m.get(v.ka)),K=z(n.get(r.column));r=z(n.get(t.column));v=v.boundary==="start"?E.start:E.end;E=K.start;t=t.boundary==="start"?r.start:r.end;return{color:w,weight:x,
Gd:q,p1:new Km(E+C*B,v),p2:new Km(t+D*B,v),...__c.Em((t-E)*B,q*x,C)}}}).filter(__c.sb);return[...h.map(q=>{var r=q.oWa,t=q.RPb,v=q.oCa;const w=q.color,x=q.weight;q=q.Gd;const B=l.get(c6(r,t))?.Aa,C=l.get(c6(r,v))?.ma;if(B!=null&&C!=null){var D=z(n.get(r.column)),E=z(m.get(t.ka));t=z(m.get(v.ka));r=r.boundary==="start"?D.start:D.end;D=E.start;v=v.boundary==="start"?t.start:t.end;return{color:w,weight:x,Gd:q,p1:new Km(r,D+B),p2:new Km(r,v+C),...__c.Em(v-D,q*x,B)}}}).filter(__c.sb),...a]},$Gc=function(a){const b=
[];a=a.filter(c=>c.weight!==0&&c.color!=null);a=__c.ym(a,c=>c.weight);a=Array.from(a.entries()).sort(([c],[d])=>c-d);for(const [c,d]of a){a=__c.ym(d,e=>`${e.Lm}_${e.Mm}`);for(const [,e]of a){const {Mm:f,Lm:g}=e[0];a=__c.ym(e,h=>h.color);for(const [h,k]of a)b.push({weight:c,color:h,lines:k,Lm:g,Mm:f})}}return b},aHc=function(a,b,c,d,e){return a.yMb(b,c,d,e)},bHc=function(a,b,c,d,e,f,g,h){var k=__c.GOb;const l=f.get().flatMap(p=>d.last()===p?[{ka:p,boundary:"start"},{ka:p,boundary:"end"}]:[{ka:p,boundary:"start"}]),
m=g.get().flatMap(p=>e.last()===p?[{column:p,boundary:"start"},{column:p,boundary:"end"}]:[{column:p,boundary:"start"}]),n=new Map;for(const p of f.get())for(const q of g.get())(f=aHc(k.Deb,a,b,c,{column:q,ka:p}))&&n.set(`${q.id}:${p.id}`,f);a=ZGc(k,a,d,e,n,l,m,h);return $Gc(a)},cHc=function(a){switch(a){case 2:return J("ibdecg");case 7:return J("446quA");case 5:return J("j1fbqg");case 1:return J("O5i4AQ");case 6:return J("C0VHsg");case 4:return J("9ND0kg");case -1:return J("RWqnLA");case 9:return J("nQR/7w");
case -2:return J("P23rtA");case 3:return J("+IXmVg");default:throw new A(a);}},dHc=function(){const [a]=(0,__c.nb)(()=>Yu());return a},eHc=function(a){return b=>({type:"react",node:(0,__c.I)(a,{...b})})},fHc=function(a){var b=a.FD;const c=a.content,d=a.context,e=a.As;__c.y(c?.Ih?.type==="formula");const f=c.wk;a={type:"dom",render:g=>g.innerText=""};switch(f.type){case 9:b=a;break;case 6:b=b.Uva?.({content:__c.nP.Wl({...__c.lKb,value:f.value}),context:d,As:e});break;case 1:case 3:case 4:case 2:case 7:case 8:b=
b.Xva?.({context:d,value:c.oE,valueType:c.wk.type});break;case 0:b={type:"react",node:d6(__c.Yv,{label:cHc(f.error),children:d6(__c.M9b,{tone:"critical"})})};break;default:throw new A(f);}return b??a},kHc=function(a){const b=a.FD,c=a.hb,d=a.Xf,e=a.IQb,f=a.fb;b.Xva=g=>__c.EQa({...g,fb:f});b.vSa=g=>fHc({...g,FD:b});b.uSa=g=>gHc({...g});b.Uva=eHc(hHc({Xf:d,NX:void 0,hb:c}));b.xSa=iHc(e,f);b.ySa=eHc(g=>d6(jHc,{...g,fb:f}))},mHc=function({label:a,gb:b,width:c,height:d,scale:e,uWa:f}){return d6("div",{style:{width:c,
height:d,transform:`scale(${e})`},className:"bx74uQ",children:e6(__c.Tv,{className:f6("ivlMMQ",lHc(f)),size:"small",alignment:"center",children:[b&&d6(b,{size:"small"}),a]})})},lHc=function(a){return{_2BX0vg:a==="primary-default",JfW_Cg:a==="primary-low",isMgNg:a==="primary-active",xwWDeQ:a==="secondary-default",w0EyUQ:a==="secondary-low",_8p5AIA:a==="secondary-active"}},nHc=function(a){return{o_1rMw:a==="primary-top",pNOpkg:a==="primary-inline-start"}},pHc=function({se:a,q2a:b,scale:c,es:d,onMouseDown:e,
onTouchStart:f,fs:g,Kjb:h,LXa:k}){const l=g6(()=>{const q=d?.get();if(q!=null&&q.length!==0)return new __c.cx(q)},[d]),m=g(1),n=g(c),p={ssE9Tg:!a,OkifGQ:a};return d6(__c.Uv,{sq:"light",light:"light",Gt:"light",dark:"light",children:q=>d6("div",{className:f6("ze9QCQ",p,q.className),style:{width:n,height:n},children:d6("div",{style:{width:m,height:m,transform:`scale(${c})`},className:f6("N7J3UA",p),onMouseDown:e,onTouchStart:f,ref:l?.Lk,children:d6(__c.dw,{className:f6("m8CFdg",p,{G6wL4w:h,W_E0wA:b,
_52RFdg:k==="move"}),ariaLabel:J("ruWN9A"),children:d6(oHc,{size:"tiny"})})})})})},rHc=function({hb:a}){const b=new qHc,c=new __c.AV,d=h6(g=>{const {scale:h=1,i2a:k,size:l="small",Kjb:m=!0}=g,n=i6(p=>b.fs({scale:p,size:l,EHa:k}),[l,k]);return d6(pHc,{...g,scale:k?Math.max(h,k):h,se:g.sheet.direction==="rtl",q2a:g.selection!=null&&b.bDb(g.sheet,a,g.selection),fs:n,Kjb:m,LXa:g.LXa,onMouseDown:g.onMouseDown,onTouchStart:g.onTouchStart})}),e=h6(g=>{const {scale:h=1,i2a:k,size:l="small",sheet:m,selection:n,
oNb:p,kNb:q}=g,r=i6(C=>b.fs({scale:C,size:l,EHa:k}),[l,k]),t=k?Math.max(h,k):h,v=i6(C=>n!=null&&b.NLa(n).has(C),[n]),w=i6(C=>n!=null&&b.wAb(m,a,n).has(C),[m,n]),x=i6(C=>{var D=a.layout.zj.$g(m);D=p!=null&&D.Ce(C,p.sc)>=0&&D.Ce(C,p.ud)<=0;return v(C)?D?"secondary-active":"primary-active":w(C)?D?"secondary-low":"primary-low":D?"secondary-default":"primary-default"},[m,p,w,v]),B=i6(C=>{if(!q||v(C))return"none";const D=a.layout.zj.$g(m);return q.some(E=>D.Ce(C,E.sc)>=0&&D.Ce(C,E.ud)<=0)?"primary-top":
"none"},[m,q,v]);return d6(j6,{...g,Dd:h,be:t,fs:r,$I:x,YI:B,WJ:c,hb:a})}),f=h6(g=>{const {scale:h=1,i2a:k,size:l="small",sheet:m,selection:n,oNb:p,kNb:q}=g,r=i6(C=>b.fs({scale:C,size:l,EHa:k}),[l,k]),t=k?Math.max(h,k):h,v=i6(C=>n!=null&&b.QLa(n).has(C),[n]),w=i6(C=>n!=null&&b.xAb(m,a,n).has(C),[m,n]),x=i6(C=>{var D=a.layout.zj.mh(m);D=p!=null&&D.Ce(C,p.fc)>=0&&D.Ce(C,p.jd)<=0;return v(C)?D?"secondary-active":"primary-active":w(C)?D?"secondary-low":"primary-low":D?"secondary-default":"primary-default"},
[m,p,w,v]),B=i6(C=>{if(!q||v(C))return"none";const D=a.layout.zj.mh(m);return q.some(E=>D.Ce(C,E.fc)>=0&&D.Ce(C,E.jd)<=0)?"primary-inline-start":"none"},[m,q,v]);return d6(k6,{...g,Dd:t,be:h,fs:r,$I:x,YI:B,WJ:c,hb:a})});return{pkb:d,okb:e,qkb:f}},sHc=function(a){const b=a.lt,c=()=>null;return __c.fv(d=>d6(l6,{...d,lt:b,mj:c}))},tHc=function({sheet:a,hb:b,Sh:c,da:d,range:e,sd:f}){m6(()=>n6(()=>{if(f.current!=null){var g=d?.get()??1,h=c.get(),k=e?DC(b.Za,a,{ka:e.fc,column:e.sc},{ka:e.jd,column:e.ud})?.sb():
void 0,l=a.direction==="rtl";f.current.style.transform=`translate(${k?k.left*g*(l?1:-1):0}px, ${k?-k.top*g:0}px)`;f.current.style.width=`${h.width*g}px`;f.current.style.height=`${h.height*g}px`}}),[a,c,b.layout.ig,b.Za,e,f,d])},wHc=function({onScroll:a}){const b=new uHc(a);return{HG:b,Fva:h6(c=>d6(vHc,{sheet:c.sheet,HG:b,children:c.children}))}},zHc=function(a){const b=a.lt,c=a.Je,d=a.Feb,e=a.hb,f=({children:m})=>m,g=({children:m})=>d6("div",{className:"Vc5nkQ",children:m}),{HG:h,Fva:k}=wHc({onScroll:a.onScroll});
class l extends xHc{get aR(){const m=this.props.ha.Ur,n=this.props.Kb;switch(m){case "screen":return k;case "print":return n.mk!=null?g:f;default:throw new A(m);}}componentDidMount(){d.peb(this.props.item,{Kb:this.props.Kb,ha:this.props.ha})}componentWillUnmount(){d.Nqb(this.props.item,{Kb:this.props.Kb,ha:this.props.ha})}render(){d.peb(this.props.item,{Kb:this.props.Kb,ha:this.props.ha});return d6(yHc,{...this.props,da:this.da,lt:b,aR:this.aR,mj:this.mj,Feb:d,hb:e,HG:h})}constructor(...m){super(...m);
this.da=o6(()=>{const n=this.props.item;var p=this.props.ha,q=p.Ur;p=p.Gk;const r=this.props.Kb;switch(q){case "screen":return p;case "print":if(r.mk!=null)return 1;q=d.pzb(n);if(!q)return 1;({width:q}=new __c.et(n,q.Kb,{Gk:p}));return q/n.config.width;default:throw new A(q);}});this.mj=h6(n=>d6("div",{className:"wKvivQ",children:d6(__c.MQa,{...this.props,...n,Je:c})}))}}return{ymb:l,HG:h}},BHc=function(a){const b=a.lt,c=a.hb,d=()=>null;return e=>d6(AHc,{...e,lt:b,mj:d,hb:c})},EHc=function(a){const b=
{transform:"translate(-1000px, -1000px) scale(0)"},c={HVa:b,aI:b,Wa:{},zE:{}},d=p6(()=>a.OD.style||c,g=>{Object.assign(a.Cha.style,g.HVa);Object.assign(a.aS.style,g.aI);Object.assign(a.tM.style,g.Wa);Object.assign(a.iI.style,g.zE);g=g?.Wa?.textDecoration;a.tM.classList.toggle("OQx3PQ",g==="underline");a.tM.classList.toggle("_99ezUA",g==="line-through");a.tM.classList.toggle("kppAqQ",g==="underline line-through")},{fireImmediately:!0,equals:CHc}),e=p6(()=>a.cGa,g=>{a.tM.classList.toggle("_84KvRA",
!g);a.Cha.classList.toggle("_84KvRA",!g);a.aS.classList.toggle("TL_RLA",!g)},{fireImmediately:!0}),f=p6(()=>a.renderer,g=>{a.ria&&g?.type!=="react"?(a.ria=void 0,a.eca.remove()):a.iI.innerHTML="";switch(g?.type){case "react":a.ria=DHc(g.node,a.eca);a.iI.appendChild(a.eca);break;case "dom":g.render(a.iI);break;case void 0:break;default:throw new A(g);}a.xIa()},{fireImmediately:!0});return()=>{d();e();f()}},CHc=function(a,b){return JSON.stringify(a)===JSON.stringify(b)},GHc=function(a){const b=a.ew,
c=a.hb,d=a.wm,e=a.oH,f=a.Vib,g=a.C9,h=a.a0,k=new FHc(d,c);return l=>d6(q6,{...l,oH:e,hb:c,wm:d,ew:b,xFa:k,Vib:f?.get(),C9:g,a0:h})};__c.FC.prototype.K3=__c.da(24,function(a,b,c){const d=[a];for(;a!=null&&a!==b;)(a=c.next(a))&&d.push(a);return d});var c6=(a,b)=>`${a.column.id}-${a.boundary}:${b.ka.id}-${b.boundary}`,hHc=({Xf:a,NX:b,hb:c})=>d=>(0,__c.I)(__c.jSb,{...d,Xf:a,NX:b,hb:c}),HHc=__webpack_require__(724707),IHc=HHc.Fragment,d6=HHc.jsx,e6=HHc.jsxs;var JHc=__webpack_require__,KHc=JHc(208463),f6=JHc.n_x(KHc)();var h6=__webpack_require__(494690).PA;var r6=__webpack_require__(979267),s6=r6.Component,xHc=r6.PureComponent,i6=r6.useCallback,m6=r6.useEffect,LHc=r6.useLayoutEffect,g6=r6.useMemo,t6=r6.useRef;var u6=__webpack_require__(186901),o6=u6.EW,n6=u6.fm,MHc=u6.m3,p6=u6.mJ,NHc=u6.MN,OHc=u6.O8,v6=u6.sH,w6=u6.XI;var PHc=__webpack_require__(536618),QHc=PHc.Aj,x6=PHc.iB,y6=PHc.uP;var z6=__webpack_require__(277049)._;var A6=__webpack_require__(269018)._;__webpack_require__(245307);var RHc=__webpack_require__(87387).A;var DHc=__webpack_require__(728600).createPortal;var SHc=class{static G(a){L(a,{viewBox:v6.ref})}constructor(){this.viewBox=(SHc.G(this),jn({top:0,left:0,height:0,width:0}));this.tOb=a=>{this.viewBox.equals(a)||(this.viewBox=a)}}},THc=h6(a=>{var b=a.sheet.direction==="rtl";b={H2wykw:!b,UweldA:b};const c=t6(new SHc),d=w6(()=>{if(a.sua){var g=a.sua.current;g&&c.current.tOb(jn({top:g.scrollTop,left:g.scrollLeft,height:g.clientHeight,width:g.clientWidth}))}});m6(()=>{d();a.sua.current?.addEventListener("scroll",d);window?.addEventListener("resize",
d);return()=>{a.sua.current?.removeEventListener("scroll",d);window?.removeEventListener("resize",d)}},[a.sua,d]);const e=g6(()=>({get:()=>c.current.viewBox}),[]),f=g6(()=>o6(()=>__c.dn(0,0,a.sheet.width,a.sheet.height)),[a.sheet]);return e6("div",{className:f6("nMvVqA",b),children:[e6("div",{ref:a.sd,className:"_0YOFPg",children:[d6(a.lt,{...a,viewport:e,Sh:f}),d6("div",{className:f6("Gdl7fQ",b),children:a.ORa?.get()?.map((g,h)=>d6(g,{},h))})]}),a.C5b==="visible"&&e6(IHc,{children:[d6("div",{className:f6("_32sKQw",
b),children:d6(a.vmb,{...a})}),d6("div",{className:f6("xdIsTQ",b),children:d6(a.zmb,{...a})}),d6("div",{className:f6("rsTRSA",b),children:d6(a.xmb,{...a})})]})]})}),UHc=h6(a=>{a=a.content;__c.u(a.type==="text2"||a.type==="text3");switch(a.type){case "text2":return a.value.stream.aa;case "text3":return __c.Mr.snapshot(a.value).cells.aa();default:throw new A(a);}});var VHc=1/13.334,gHc=eHc(h6(a=>{var b=a.context;const c=a.value,d=a.onChange,e=b.attrs;b=b.container.column;__c.y(a.valueType===3);const f=i6(m=>{d?.(c,m.target.checked)},[d,c]),g=e.fontSize??Eg.Xb.fontSize,h=b.width;a=g6(()=>{const m=20*g*VHc;return`${Math.round(m*Math.min(1,(h-__c.SV*2)/m))}px`},[g,h]);b=g6(()=>{var m=e.color??Eg.Xb.color,n=e.yE??Eg.Xb.yE;const {h:p,s:q,wa:r}=__c.ns(m),t=__c.ls(new __c.fs(p,q*.59,r*.69)).Zp(),v=__c.ls(new __c.fs(p,q*.68,r*.84)).Zp(),w=__c.ss(__c.rs(__c.ls(m),.5));
return{ZVa:m,Bqb:t,$Va:v,Cqb:n!=="transparent"?n:"#ffffff",Dqb:w}},[e]);const k=__c.zv(),l=i6(m=>{m.nativeEvent.cancelable&&m.preventDefault();m.stopPropagation();w6(()=>{d&&d(c,!c)})()},[d,c]);return d6("label",{className:f6("s5Xvtg",{_0YWo_Q:k,agLBbw:d==null}),onTouchEnd:l,children:e6("div",{className:"nOL94A",style:{"--V8rdkw":a,"--6kHV0A":b.ZVa,"--dhlyXQ":b.Bqb,"--pMrTCg":b.$Va,"--EyYwbg":b.ZVa,"--3ZWdlg":b.$Va,"--81jhOQ":b.Cqb,"--Cs3XTw":b.Dqb},children:[d6("input",{type:"checkbox",checked:c,
onChange:w6(m=>f(m)),className:"p8DDOg",hidden:!0}),d6("span",{"aria-hidden":!0,className:f6("l_S_Ng",{iGjddQ:c}),children:d6(WHc,{})})]})})})),WHc=()=>d6("svg",{className:"_8CNofA",viewBox:"0 0 10 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:d6("path",{d:"M0.750977 4.5L3.25098 7L9.25098 1",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})});var iHc=(a,b)=>__c.nQa((c,d)=>{const e=c.content;c=c.context;if(e.value.stream.isEmpty)for(;d.lastChild;)d.lastChild.remove();else({Mh:c}=__c.kg(Eg,c.attrs)),c==="wrap"&&(d=d.appendChild(document.createElement("div")),d.className="dt4Dlg"),a.render({container:d,text:e.value,oa:void 0,writingMode:1,qd:"start",bf:XHc(e,c),fb:b})}),XHc=x6((a,b)=>{if(b==="wrap")return[];a=a.value.stream.aa.split("\n").map(c=>c.length+1);a.pop();return a},{equals:MHc.structural});var YHc,ZHc,$Hc,jHc;
new (YHc=class extends z6{constructor(){super(jHc);ZHc()}},(()=>{class a extends($Hc=s6){static G(b){L(b,{Mh:o6})}get Mh(){return __c.kg(Eg,this.props.context.attrs).Mh}render(){var b=this.props.content;const c=this.props.context;if(b.value.isEmpty)return null;b=d6(this.props.mj,{content:b,ka:c.container.ka,col:c.container.column,Mh:this.Mh});return this.Mh==="wrap"?d6("div",{className:"dt4Dlg",children:b}):b}constructor(...b){super(...b);a.G(this)}}({c:[jHc,ZHc]}=A6(a,[],[oc],$Hc))})(),YHc);var aIc=class{static K3(a,b,c){const d=[a];for(;a!=null&&a!==b;)(a=c.next(a))&&d.push(a);return d}static t9(a,b,c){__c.u(a.layout.cols.has(b),"Column not found in sheet");__c.u(a.layout.rows.has(c),"Row not found in sheet");var d=a.layout.cells.get(c,b);const {sc:e,fc:f,ud:g,jd:h}=d?.span||{sc:b,fc:c,ud:b,jd:c};b=a.ma(f);c=a.ma(h)+h.height-b;d=a.qa(e);a=a.qa(g)+g.width-d;return jn({top:b,left:d,width:a,height:c})}};var qHc=class{fs({size:a,scale:b,EHa:c}){b=c?Math.max(c,b):b;return a==="large"?__c.rY*b:__c.I8b*b}constructor(){this.bDb=x6((a,b,c)=>{c=c.get();const d=b.layout.zj.mh(a);a=b.layout.zj.$g(a);return c!=null&&d.count()===(c.rows?.size||0)&&a.count()===(c.columns?.size||0)});this.NLa=QHc(a=>new Set(a.get()?.columns||[]),{equals:__c.mm});this.QLa=QHc(a=>new Set(a.get()?.rows||[]),{equals:__c.mm});this.wAb=x6((a,b,c)=>{var {cells:d}=c.get()||{};if(!d)return new Set;var e=this.QLa(c);b=b.layout.zj.$g(a);
if(e.size>0)return new Set(b);c=this.NLa(c);e=new Set;for(const f of d){d=a.layout.cells.get(f.ka,f.column);for(const g of aIc.K3(d?d.span.sc:f.column,d?d.span.ud:f.column,b))(c.size===0||c.has(g))&&e.add(g)}return e},{equals:__c.mm});this.xAb=x6((a,b,c)=>{var {cells:d}=c.get()||{};if(!d)return new Set;var e=this.NLa(c);b=b.layout.zj.mh(a);if(e.size>0)return new Set(b);c=this.QLa(c);e=new Set;for(const f of d){d=a.layout.cells.get(f.ka,f.column);for(const g of aIc.K3(d?d.span.fc:f.ka,d?d.span.jd:
f.ka,b))(c.size===0||c.has(g))&&e.add(g)}return e},{equals:__c.mm})}};var bIc,cIc,dIc,eIc,fIc,gIc,hIc=parseInt("4px",10)||4,iIc=parseInt("0.5px",10)||.5,jIc=parseInt("1px",10)||1,kIc=parseInt("0.5px",10)||.5,lIc=parseInt("0.5px",10)||.5,mIc=parseInt("1px",10)||1,nIc=parseInt("0.5px",10)||.5,j6;
new (bIc=class extends z6{constructor(){super(j6);dIc()}},(()=>{class a extends(eIc=s6){static G(b){L(b,{se:o6,Wt:o6,Lda:o6})}get se(){return this.props.sheet.direction==="rtl"}get Wt(){const b=this.props.es?.get();if(b!=null&&b.length!==0)return new __c.cx(b)}get Lda(){return this.props.TDa?.()?.get()}render(){return d6(__c.Uv,{sq:"light",light:"light",Gt:"light",dark:"light",children:this.lrb})}constructor(...b){super(...b);this.onMouseMove=(j6.G(this),w6(c=>{const {onMouseMove:d,sheet:e,Dd:f=1}=
this.props;d?.(c,e,"column",f)}));this.onMouseLeave=w6(c=>{this.props.onMouseLeave?.(c)});this.onMouseDown=w6(c=>{this.props.onMouseDown?.(c)});this.onTouchStart=w6(c=>{this.props.onTouchStart?.(c)});this.ubb=(c,d,e)=>{const {sheet:f,hb:g,fs:h,$I:k,YI:l,Q5b:m,Dd:n=1,be:p=1}=this.props,q={jNbTIg:!this.se,gtA7Dw:this.se};var r=e?.sticky?this.se?{right:0}:{left:0}:void 0;r=e?.sticky?this.Lda??r:void 0;let t=0;const v=g.layout.ig.$g(f),w=v.map(B=>{if(!(c&&v.Ce(B,c)<0||d&&v.Ce(B,d)>0))return t+=B.width,
d6(oIc,{col:B,label:__c.Du(f.ev(B)),gb:m?.get()?.get(B),fs:h,$I:k,YI:l,Dd:n,be:p,start:g.Za.qa(f,B)},B.id)}),x=this.se?{right:t*n}:{left:t*n};return e6("div",{style:{height:h(p),width:t*n,...r},className:f6("Vt2_4w",q,{Tn3nUw:e?.sticky}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:[w,e?.sticky&&d6("div",{style:{width:hIc*n,...x},className:f6("HBvlug","ru3tFQ",q)})]})};this.lrb=c=>{var d=this.props.sheet;const e=this.props.hb,f=e.layout.ig.g9(d),g={jNbTIg:!this.se,gtA7Dw:this.se};
d=e.layout.ig.$g(d);return e6("div",{ref:this.Wt?.Lk,onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,className:f6("xhBZaw",g,c.className),children:[f&&this.ubb(void 0,f,{sticky:!0}),this.ubb(f?d.next(f):void 0)]})}}}({c:[j6,dIc]}=A6(a,[],[oc],eIc))})(),bIc);var k6;
new (cIc=class extends z6{constructor(){super(k6);fIc()}},(()=>{class a extends(gIc=s6){static G(b){L(b,{se:o6,Wt:o6,Lda:o6})}get se(){return this.props.sheet.direction==="rtl"}get Wt(){const b=this.props.es?.get();if(b!=null&&b.length!==0)return new __c.cx(b)}get Lda(){return this.props.TDa?.()?.get()}render(){return d6(__c.Uv,{sq:"light",light:"light",Gt:"light",dark:"light",children:this.QMb})}constructor(...b){super(...b);this.onMouseMove=(k6.G(this),w6(c=>{const {onMouseMove:d,sheet:e,be:f=1}=
this.props;d?.(c,e,"row",f)}));this.onMouseLeave=w6(c=>{this.props.onMouseLeave?.(c)});this.onMouseDown=w6(c=>{this.props.onMouseDown?.(c)});this.onTouchStart=w6(c=>{this.props.onTouchStart?.(c)});this.zbb=(c,d,e)=>{const {sheet:f,hb:g,fs:h,$I:k,YI:l,Dd:m=1,be:n=1}=this.props,p={jNbTIg:!this.se,gtA7Dw:this.se};var q=e?.sticky?{top:0}:void 0;q=e?.sticky?this.Lda??q:void 0;let r=0;const t=g.layout.ig.mh(f),v=t.map(w=>{if(!(c&&t.Ce(w,c)<0||d&&t.Ce(w,d)>0)){r+=w.height;var x=`${f.Yv(w)+1}`;return d6(pIc,
{ka:w,label:x,$I:k,YI:l,fs:h,Dd:m,be:n,start:g.Za.ma(f,w)},w.id)}});return e6("div",{style:{height:r*n,width:h(m),...q},className:f6("_93roJg",p,{Tn3nUw:e?.sticky}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:[v,e?.sticky&&d6("div",{style:{height:hIc*n},className:f6("HBvlug","koz2Hg")})]})};this.QMb=c=>{var d=this.props.sheet;const e=this.props.hb,f=e.layout.ig.h9(d),g={jNbTIg:!this.se,gtA7Dw:this.se};d=e.layout.ig.mh(d);return e6("div",{ref:this.Wt?.Lk,onMouseDown:this.onMouseDown,
onTouchStart:this.onTouchStart,className:f6("An9VeA",g,c.className),children:[f&&this.zbb(void 0,f,{sticky:!0}),this.zbb(f?d.next(f):void 0)]})}}}({c:[k6,fIc]}=A6(a,[],[oc],gIc))})(),cIc);
var oIc=h6(a=>{const b=a.label,c=a.gb,d=a.col,e=a.$I,f=a.YI,g=a.fs,h=a.Dd,k=a.be,l=g(k),m=y6(()=>e(d)),n=y6(()=>f(d));return d6("div",{className:f6("_83Rssw","d2uLIA",lHc(m),nHc(n)),style:{width:d.width*h,height:l,borderInlineWidth:`${iIc*h}px`,borderBlockStartWidth:n==="none"?`${jIc*h}px`:void 0,borderBlockEndWidth:`${kIc*h}px`,transform:`translateX(${a.start*h}px)`},children:d6(mHc,{label:b,gb:c,width:d.width,height:g(1),scale:k,uWa:m})})}),pIc=h6(a=>{const b=a.label,c=a.ka,d=a.fs,e=a.$I,f=a.YI,
g=a.Dd,h=a.be,k=d(g),l=y6(()=>e(c)),m=y6(()=>f(c));return d6("div",{className:f6("_83Rssw","JhBzyw",lHc(l),nHc(m)),style:{width:k,height:c.height*h,borderBlockWidth:`${lIc*h}px`,borderInlineStartWidth:m==="none"?`${mIc*h}px`:void 0,borderInlineEndWidth:`${nIc*h}px`,transform:`translateY(${a.start*h}px)`},children:d6(mHc,{label:b,width:d(1),height:c.height,scale:g,uWa:l})})});var qIc='<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="6" cy="6" r="5.5"/></svg>';var rIc='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="12" cy="12" r="9.25" stroke-width="1.5"/></svg>';var oHc=__c.gV({Zo:qIc,medium:rIc});var sIc,tIc,uIc,l6;
new (sIc=class extends z6{constructor(){super(l6);tIc()}},(()=>{class a extends(uIc=s6){static G(b){L(b,{Of:o6.struct})}render(){const b=this.props.element;return d6(this.props.lt,{sheet:b.D.config,container:b,Sh:this.Sh,eha:"visible",es:this.props.es,bw:this.props.bw,tx:this.props.tx,wx:this.props.wx,da:this.props.da,Of:this.Of,mj:this.props.mj,KL:void 0})}get Of(){return __c.lm(this.props.element.D.Ya,this.props.sg)}constructor(...b){super(...b);this.Sh=(l6.G(this),o6(()=>{const c=this.props.element.D.config;
return __c.dn(0,0,c.width,c.height)}))}}({c:[l6,tIc]}=A6(a,[],[oc],uIc))})(),sIc);var vIc=class{constructor(){this.Ora=new WeakMap;this.pzb=a=>this.Ora.get(a);this.peb=(a,b)=>{this.Ora.set(a,b)};this.Nqb=(a,b)=>{const c=this.Ora.get(a);c&&c.ha===b.ha&&c.Kb===b.Kb&&this.Ora.delete(a)}}};var wIc=parseInt("4px",10)||4,xIc=h6(({sheet:a,hb:b,Sh:c,da:d,range:e,Bz:f,Cz:g})=>{if(e!=null&&(f||g)){d=d?.get()??1;c=c.get();var h=a.direction==="rtl",k={ZJ0G6w:!h,dOI_jA:h};a=DC(b.Za,a,{ka:e.fc,column:e.sc},{ka:e.jd,column:e.ud})?.sb();if(a!=null){if(f&&g)return d6("div",{style:{top:(a.top+a.height)*d,width:a.width*d,height:wIc*d},className:f6("aX8dhQ","VGcLng")});if(f)return f=a.left+a.width,d6("div",{style:{width:wIc*d,height:c.height*d,...(h?{right:f*d}:{left:f*d})},className:f6("aX8dhQ","gl1RPg",
k)});if(g)return d6("div",{style:{top:(a.top+a.height)*d,width:c.width*d,height:wIc*d},className:f6("aX8dhQ","VGcLng")})}}});var B6=({sheet:a,hb:b,range:c,Sh:d,da:e,children:f})=>{const g=dHc();tHc({sheet:a,hb:b,Sh:d,da:e,range:c,sd:g});return d6("div",{ref:g,className:f6("nstn2A",a.direction==="rtl"?"NgnL2Q":"f8jAGQ"),children:f})},yIc=({sheet:a,hb:b,range:c,Sh:d,da:e,children:f})=>{const g=dHc();tHc({sheet:a,hb:b,Sh:d,da:e,range:c,sd:g});a=a.direction==="rtl"?"NgnL2Q":"f8jAGQ";return d6("div",{className:f6("nstn2A",a,"_9sodyg"),children:d6("div",{ref:g,className:f6("nstn2A",a),children:f})})};var vHc=h6(({sheet:a,children:b,HG:c})=>{const d=i6(f=>{c.OMa(a,f)},[c,a]),e=i6(f=>{f!=null?c.IG.set(a,f):c.IG.delete(a)},[c,a]);return d6(__c.V5b,{direction:a.config.direction==="rtl"?"rtl":"ltr",onScroll:d,jy:e,children:b})}),uHc=class{OMa(a,b){this.onScroll&&this.onScroll(a);this.Sca.set(a,b)}constructor(a){this.onScroll=a;this.IG=new WeakMap;this.Sca=v6.map(new Map,{deep:!1});this.scrollTo=w6((b,c)=>{this.IG.get(b)?.scrollTo({left:Math.floor(c)})})}};var yHc=h6(a=>{const b=a.item,c=a.es,d=a.bw,e=a.Cg,f=a.measureRef,g=a.da,h=a.A3a,k=a.Kb,l=a.tx,m=a.wx,n=a.lt,p=a.aR,q=a.mj,r=a.sg,t=a.hb,v=a.HG;a=g6(()=>__c.lm(b.Ya,r),[b,r]);const w=g6(()=>o6(()=>{const E=b.config;return __c.dn(0,0,E.width,E.height)}),[b]),x=g6(()=>h6(({sheet:E,range:K,Bz:M,Cz:N})=>d6(B6,{sheet:E,hb:t,range:K,Sh:w,da:g,children:d6(xIc,{sheet:E,hb:t,Sh:w,da:g,range:K,Bz:M,Cz:N})})),[g,w,t]),B=__c.txa(b.config),C=g.get(),D=Math.min(B.width*C,k.width);m6(()=>n6(()=>{var E=b.config.view.freeze.fI?
b.config.layout.Qe.get(b.config.view.freeze.fI):void 0;if(E!=null)if(b.config.qa(E)+E.width>D){if(E=v.IG.get(b))E.style.overflowX="hidden"}else if(E=v.IG.get(b))E.style.overflowX="scroll"}),[b,k.width,v,C,D]);return d6("div",{ref:f,className:"E8r86A",style:{width:D},children:d6(p,{sheet:b,children:d6("div",{ref:h,className:"cXTiJA",style:{width:B.width*C,height:B.height*C},children:d6("div",{className:"W1ir5A",children:d6(n,{container:e.Xj(b),sheet:b.config,Sh:w,eha:"visible",es:c,bw:d,da:g,tx:l,
wx:m,Of:a,mj:q,KL:x})})})})})});var zIc=h6(({page:a,hb:b,range:c,wG:d})=>{var e=c!=null&&c.sc!=null&&c.fc!=null&&c.ud!=null&&c.jd!=null?DC(b.Za,a.sheet,{ka:c.fc,column:c.sc},{ka:c.jd,column:c.ud}):void 0;return d6("div",{className:"Gi9pfA",children:a.elements.map((f,g)=>e==null?d(f,g):__c.gn(jn(f)).qs(e)&&d(f,g))})});var AIc=new __c.AV,BIc=a=>__c.rY*a,CIc=()=>"primary-default",DIc=()=>"none",AHc=h6(({container:a,es:b,bw:c,tx:d,wx:e,G9:f,da:g,viewport:h,hb:k,aPb:l,lt:m,mj:n,wG:p,Cqa:q,KXb:r,qWb:t,pWb:v})=>{const w=a.page,x=g6(()=>o6(()=>{{var C=k.Za;var D=w.sheet,E=C.HA.zj.mh(D),K=C.HA.zj.$g(D);const M=E.first(),N=K.first();E=E.last();K=K.last();C=M&&N&&E&&K?DC(C,D,{ka:M,column:N},{ka:E,column:K}):void 0}return C??__c.dn(0,0,0,0)}),[w,k]),B=g6(()=>h6(({sheet:C,range:D,Bz:E,Cz:K})=>e6(IHc,{children:[d6(B6,{sheet:w.sheet,
hb:k,range:D,Sh:x,da:g,children:d6(xIc,{sheet:C,hb:k,Sh:x,da:g,range:D,Bz:E,Cz:K})}),e6(yIc,{sheet:w.sheet,hb:k,range:D,Sh:x,da:g,children:[r&&d6(r,{}),p&&d6(zIc,{page:w,hb:k,wG:p,range:D}),v&&d6(v,{}),q&&q()]}),t&&D&&d6(B6,{sheet:w.sheet,hb:k,range:D,Sh:x,da:g,children:d6(t,{range:D})})]})),[w,k,x,g,r,p,v,q,t]);return l?d6(EIc,{container:a,Sh:x,viewport:h,da:g,es:b,bw:c,tx:d,wx:e,lt:m,mj:n,KL:B,hb:k}):d6(m,{sheet:w.sheet,container:a,Sh:x,eha:"hidden",es:b,bw:c,tx:d,wx:e,G9:f,da:g,viewport:h,mj:n,
KL:B})}),EIc=h6(a=>{const b=a.container,c=a.Sh,d=a.da,e=a.viewport,f=a.es,g=a.bw,h=a.tx,k=a.wx,l=a.lt,m=a.mj,n=a.KL;a=a.hb;const p=b.page,q=p.sheet.direction==="rtl",r=t6(null),t=t6(null),v=t6(null);m6(()=>{const D=C6({sheet:p.sheet,zsa:!0,Asa:!0,da:d,viewport:e});return p6(()=>D?.get(),E=>{const K=r.current;if(E&&K){var M=p.sheet.direction==="rtl";K.style.position=E.position??"sticky";K.style.top=E.top??"0px";M?K.style.right=E.right??"0px":K.style.left=E.left??"0px";K.style.transform=E.transform??
""}})},[p.sheet,d,e]);m6(()=>{const D=C6({sheet:p.sheet,zsa:!1,Asa:!0,da:d,viewport:e});return p6(()=>D?.get(),E=>{const K=v.current;E&&K&&(K.style.position=E.position??"sticky",K.style.top=E.top??"0px",K.style.transform=E.transform??"")})},[p.sheet,d,e]);m6(()=>{const D=C6({sheet:p.sheet,zsa:!0,Asa:!1,da:d,viewport:e});return p6(()=>D?.get(),E=>{const K=t.current;if(E&&K){var M=p.sheet.direction==="rtl";K.style.position=E.position??"sticky";M?K.style.right=E.right??"0px":K.style.left=E.left??"0px";
K.style.transform=E.transform??""}})},[p.sheet,d,e]);const w=i6((D,E,K)=>C6({sheet:D,zsa:E,Asa:K,da:d,viewport:e}),[d,e]),x=g6(()=>w?()=>w(p.sheet,!0,!1):void 0,[w,p.sheet]),B=g6(()=>w?()=>w(p.sheet,!1,!0):void 0,[w,p.sheet]),C=d?.get()??1;return e6("div",{className:f6("OsKKIQ","cbOp6Q"),children:[d6("div",{className:"VDFv_A",children:d6(l,{sheet:p.sheet,container:b,Sh:c,eha:"hidden",es:f,bw:g,tx:h,wx:k,G9:w,da:d,viewport:e,mj:m,KL:n})}),d6("div",{ref:r,className:"_688KWg",children:d6(pHc,{se:q,q2a:!1,
fs:BIc,scale:C})}),d6("div",{ref:v,className:"m0cT1w",children:d6(j6,{sheet:p.sheet,Dd:C,be:C,fs:BIc,$I:CIc,YI:DIc,WJ:AIc,TDa:x,hb:a})}),d6("div",{ref:t,className:"zm537g",children:d6(k6,{sheet:p.sheet,Dd:C,be:C,fs:BIc,$I:CIc,YI:DIc,WJ:AIc,TDa:B,hb:a})})]})}),C6=({sheet:a,zsa:b,Asa:c,da:d,viewport:e})=>o6(()=>{var f=e?.get().sb();const g=d?.get()??1;if(!f)return{};const h={};f=new Km(f.left,f.top);const k=a.direction==="rtl";h.position="relative";c&&(h.top="0px");b&&(k?h.right="0px":h.left="0px");
h.transform=`translate(${b?f.x*g:0}px, ${c?f.y*g:0}px)`;return h});var FHc=class{constructor(a,b){this.wm=a;this.hb=b;this.lqb=__c.SV;this.Ryb=x6((c,d,e,f)=>{e=e.get();const g=new WeakMap;for(let v=0;v<e.length;v++){var h=e[v],k=this.Iyb(c,d,h);if(k){switch(k){case "start":case "justify":var l=e[v+1];if(l==null||!EC(c,this.hb,d,l))continue;break;case "center":l=e[v+1];if(l==null||!EC(c,this.hb,d,l))continue;l=e[v-1];if(l==null||!EC(c,this.hb,d,l))continue;break;case "end":l=e[v-1];if(l==null||!EC(c,this.hb,d,l))continue;break;default:throw new A(k);}if(l=f(d,h)){var m=
l.width+(k==="center"?0:this.lqb);if(!(h.width>m)){switch(k){case "start":case "justify":k=this.hb.Za.qa(c,h);l=k+m;break;case "center":l=this.hb.Za.qa(c,h)+h.width/2;k=l-m/2;l+=m/2;break;case "end":l=this.hb.Za.qa(c,h)+h.width;k=l-m;break;default:throw new A(k);}for(m=e.indexOf(h);m>=0;m--){var n=e[m],p=m-1<0||EC(c,this.hb,d,e[m-1]),q;if(q=n===h||EC(c,this.hb,d,n)){q=k;var r=l,t=this.hb.Za.qa(c,n);q=q<t&&t<r}if(q&&p)g.set(n,1);else break}for(h=e.indexOf(h)+1;h<e.length;h++){m=e[h];if(n=EC(c,this.hb,
d,m))n=k,p=l,q=this.hb.Za.qa(c,m),n=n<q&&q<p;if(n)g.set(m,1);else break}}}}}return g});this.Iyb=(c,d,e)=>{const f=c.layout.cells.get(d,e);if(f&&(f.ref.content.ref||f.ref.Ga.ref)&&f.span.fc===f.span.jd&&f.span.sc===f.span.ud){var g=this.wm.Ho(c,d,e);c=this.wm.NDa(c,d,e,__c.Fg({Mh:void 0,textAlign:void 0}));var {Mh:h,textAlign:k}=__c.kg(Eg,c);if(h==="overflow")return __c.rQa(k,f.ref.content.ref?.type,f.ref.Ga.ref?.type,g?()=>g.wk.type:void 0)}}}};var FIc=h6(function(a){const b=a.sheet;var c=a.hb,d=a.pX;const e=a.HUb,f=a.da,g=a.xFa,h=a.wyb,k=a.overflow,l=a.Sh,m=dHc();LHc(()=>n6(()=>{const w=z(m.current),x=f?.get()??1,{width:B,height:C}=l.get();w.style.width=`${B*x}px`;w.style.height=`${C*x}px`}),[m,f,l]);const n=i6(w=>g.Ryb(b,w,e,h),[g,b,e,h]);a=i6((w,x)=>n(w)?.get(x)??0,[n]);const p=c.layout.zj.mh(b),q=c.layout.zj.$g(b),r=c.layout.ig.mh(b);c=c.layout.ig.$g(b);d=bHc(b,p,q,r,c,d,e,a);const {width:t,height:v}=l.get();c=b.direction==="rtl";return d6("svg",
{ref:m,role:"presentation",className:f6("c6a1eQ",{H_CtIQ:!c,_8_56PQ:c,_3NnFzw:k==="visible",JMH1ng:k==="hidden"}),viewBox:`0 0 ${t} ${v}`,strokeLinecap:"butt",strokeLinejoin:"miter",children:d.map(({lines:w,color:x,weight:B,Lm:C,Mm:D})=>d6("path",{stroke:x,strokeDasharray:C,strokeDashoffset:D,strokeWidth:B,d:w.map(({p1:E,p2:K})=>`M ${E.x} ${E.y} L ${K.x} ${K.y}`).join(" ")},`${x}-${B}-${C}-${D}`))})});var GIc;GIc=Symbol.iterator;
var HIc=class{get size(){return this.isa}get([a,b]){return(a=this.DJ.get(a))?a.get(b):void 0}has([a,b]){a=this.DJ.get(a);return a==null?!1:a.has(b)}set([a,b],c){let d=this.DJ.get(a);d==null&&(d=new Map,this.DJ.set(a,d));d.set(b,c);this.isa++;return this}clear(){this.DJ.clear();this.isa=0}delete([a,b]){const c=this.DJ.get(a);if(c==null||!c.delete(b))return!1;this.isa--;c.size===0&&this.DJ.delete(a);return!0}forEach(a){for(const [b,c]of this.DJ)for(const [d,e]of c)a([b,d],e)}*[GIc](){for(const [a,b]of this.DJ)for(const [c,
d]of b)yield[[a,c],d]}constructor(){this.isa=0;this.DJ=new Map}};var IIc,JIc,KIc,LIc,MIc,NIc,OIc,PIc,QIc=class extends s6{render(){const {Vka:a,C9:b,...c}=this.props,d=this.props.sheet;return e6("div",{ref:this.Ieb,className:f6("ZTz_iA",d.direction==="ltr"?"TA4X7w":"WvuqMw"),children:[a?.EUa&&d6(D6,{...c,sheet:d,range:a.EUa.range,Bz:!0,Cz:!0,className:"_0C8M3w"}),a?.ijb&&d6(D6,{...c,sheet:d,range:a.ijb.range,Bz:!1,Cz:!0,className:"_7n44yg"}),a?.t2a&&d6(D6,{...c,sheet:d,range:a.t2a.range,Bz:!0,Cz:!1,className:"fF5r6w"}),a?.fib&&d6(D6,{...c,sheet:d,range:a.fib.range,
Bz:!1,Cz:!1,className:"llILYw"}),d6(this.$lb,{})]})}componentDidMount(){const a=n6(()=>{var b=this.props,c=b.da;b=b.Sh;const d=this.Ieb.current;if(d){c=c?c.get():1;const {width:e,height:f}=b.get();d.style.width=`${e*c}px`;d.style.height=`${f*c}px`}});__c.fc(this,[a])}constructor(...a){super(...a);this.Ieb=Yu();this.$lb=h6(()=>{const b=this.props.C9;var c=this.props.a0,d=this.props.ew;const e=this.props.container,f=this.props.sheet;var g=this.props.hb,h=this.props.da;const k=f.layout.rows.first(),
l=f.layout.cols.first();if(!b||!k||!l)return null;const m=g6(()=>b?.(e,f,k,l),[b,e,f,k,l])?.get();if(!m)return null;h=h.get();const n=g.Za.ma(f,k)*h+h;g=g.Za.qa(f,l)*h+h;const p=c?.();c=p?.fontSize?p.fontSize*h:void 0;d=p?.fontFamily?d?.T2(p.fontFamily):void 0;return d6("div",{className:"_6eq__A",style:{top:n,left:g,height:k.height*h-h*2,paddingLeft:`${__c.SV*h}px`,fontSize:c,fontFamily:d},children:m})})}};({c:[PIc,KIc]}=A6(QIc,[],[oc],s6));KIc();var D6;
new (IIc=class extends z6{constructor(){super(D6);LIc()}},(()=>{class a extends(MIc=s6){static G(b){L(b,{eNa:o6,bounds:o6})}get eNa(){const b=this.props.viewport,c=this.props.Bz,d=this.props.Cz;return b==null||!c&&!d?b:o6(()=>{const e=b.get().sb();return jn({top:d?0:e.top,left:c?0:e.left,width:e.width,height:e.height})})}render(){const b=this.props.sheet,c=this.props.Sh,d=this.props.container,e=this.props.range,f=this.props.KL,g=this.props.Bz,h=this.props.Cz;return e6("div",{ref:this.DJa,className:f6("i0YQww",
this.props.className),children:[d6("div",{ref:this.q$a,className:"vUKoKg",children:d6("div",{ref:this.r$a,children:d6(E6,{sheet:b,container:d,Sh:c,bounds:e,es:this.props.es,bw:this.props.bw,oH:this.props.oH,mj:this.props.mj,m7:this.props.m7,hb:this.props.hb,da:this.props.da,pX:this.pX,lfa:this.lfa,rZ:this.rZ,a0:this.props.a0})})}),d6(this.Gva,{}),f&&d6(f,{sheet:b,range:e,Bz:g,Cz:h})]})}componentDidMount(){const b=n6(()=>{var h=this.props,k=h.da,l=h.sheet,m=h.Sh,n=h.hb,p=this.DJa.current;const q=this.q$a.current;
h=this.r$a.current;var r=this.bounds,t=r.sc;const v=r.ud,w=r.fc;r=r.jd;k=k?k.get():1;const {width:x,height:B}=m.get();n=(m=w&&t&&r&&v?DC(n.Za,l,{ka:w,column:t},{ka:r,column:v})?.sb():void 0)?m.width:x;t=m?m.height:B;p&&(p.style.width=`${n*k}px`,p.style.height=`${t*k}px`);q&&(q.style.width=`${n*k}px`,q.style.height=`${t*k}px`);l=l.direction==="rtl";l=m?m.left*k*(l?1:-1):0;p=m?-m.top*k:0;h&&(h.style.transform=`translate(${l}px, ${p}px)`)}),c=this.props.sheet;var d=this.props.G9;const e=this.props.Bz,
f=this.props.Cz,g=e||f?d?.(c,e,f):void 0;d=n6(()=>{const h=this.DJa.current;if(h!=null){var k=e||f?"sticky":"relative",l=f?"0px":"unset",m=e?"0px":"unset",n=e?"0px":"unset",p=c.direction==="rtl";if(g==null)h.style.position=k,h.style.top=l,h.style.left=p?"unset":m,h.style.right=p?n:"unset";else{const q=g.get();h.style.position=q.position??k;h.style.top=q.top??l;h.style.left=p?"unset":q.left??m;h.style.right=p?q.right??n:"unset";h.style.transform=q.transform??"unset"}}});__c.fc(this,[b,d])}get bounds(){var b=
this.props.sheet,c=this.props.hb,d=this.props.range;const e=c.layout.zj.mh(b);b=c.layout.zj.$g(b);if(b.empty||e.empty)return{sc:void 0,ud:void 0,fc:void 0,jd:void 0};c=d.sc;const f=d.ud,g=d.fc;d=d.jd;const h=b.first(),k=e.first(),l=b.last(),m=e.last();return{sc:c?b.has(c)?c:void 0:h,ud:f?b.has(f)?f:void 0:l,fc:g?e.has(g)?g:void 0:k,jd:d?e.has(d)?d:void 0:m}}constructor(...b){super(...b);this.DJa=(D6.G(this),Yu());this.q$a=Yu();this.r$a=Yu();this.rZ=new RIc;this.IUb=o6(()=>[...this.pX.get().keys()].sort((c,
d)=>this.props.hb.layout.ig.mh(this.props.sheet).Ce(c,d)),{equals:__c.nm()});this.GUb=o6(()=>[...this.lfa.get().keys()].sort((c,d)=>this.props.hb.layout.ig.$g(this.props.sheet).Ce(c,d)),{equals:__c.nm()});this.Gva=h6(()=>d6(this.props.umb,{pX:this.IUb,HUb:this.GUb,wyb:this.rZ.u9,range:this.props.range}));this.pX=o6(()=>{const c=this.props.sheet;var d=this.props.da;const e=this.props.hb;var f=this.eNa?.get();if(f&&(f.height<=0||f.width<=0))return new Map;const g=this.bounds;d=d.get();var h=50*d,k=
!f&&g.fc&&g.sc&&g.jd&&g.ud?DC(e.Za,c,{ka:g.fc,column:g.sc},{ka:g.jd,column:g.ud})?.sb():void 0;const l=f?f.ra.y-h:k?.top??0;f=f?f.br.y+h:k?.height??0;h=new Map;k=e.layout.zj.mh(c);const m=e.layout.ig.mh(c);for(let n=g.fc;n!=null&&g.jd!=null&&k.Ce(n,g.jd)<=0;n=k.next(n)){if(!m.has(n))continue;const p=e.Za.ma(c,n);if(!(p+n.height<l)){if(p>f)break;h.set(n,p*d)}}return h},{equals:MHc.shallow});this.lfa=o6(()=>{const c=this.props.sheet;var d=this.props.da;const e=this.props.hb;var f=this.eNa?.get();if(f&&
(f.height<=0||f.width<=0))return new Map;const g=this.bounds;d=d.get();var h=50*d,k=!f&&g.fc&&g.sc&&g.jd&&g.ud?DC(e.Za,c,{ka:g.fc,column:g.sc},{ka:g.jd,column:g.ud})?.sb():void 0;const l=f?f.ra.x-h:k?.left??0;f=f?f.br.x+h:k?.width??0;h=new Map;k=e.layout.zj.$g(c);const m=e.layout.ig.$g(c);for(let n=g.sc;n!=null&&g.ud!=null&&k.Ce(n,g.ud)<=0;n=k.next(n)){if(!m.has(n))continue;const p=e.Za.qa(c,n);if(!(p+n.width<l)){if(p>f)break;h.set(n,p*d)}}return h},{equals:MHc.shallow})}}({c:[D6,LIc]}=A6(a,[],[oc],
MIc))})(),IIc);var RIc=class{constructor(){this.cells=new HIc;this.NKa=(a,b,c)=>{let d=this.cells.get([a,b]);d==null&&(d=v6.box(void 0,{deep:!1}),this.cells.set([a,b],d));d.set(c);return()=>{const e=this.cells.get([a,b]);e===d&&(e.set(void 0),this.cells.delete([a,b]))}};this.u9=(a,b)=>{let c=this.cells.get([a,b]);c==null&&(c=v6.box(void 0,{deep:!1}),this.cells.set([a,b],c));return c.get()?.UWa}}},E6;
new (JIc=class extends z6{constructor(){super(E6);NIc()}},(()=>{class a extends(OIc=s6){static G(b){L(b,{JQ:v6.shallow,Wt:o6,dUa:w6,Cia:w6.bound})}get Wt(){const b=this.props.es?.get();if(b!=null&&b.length!==0)return new __c.cx(b)}render(){return e6("div",{onMouseDown:this.props.bw?.onMouseDown,onTouchStart:this.props.bw?.onTouchStart,ref:RHc(this.sd,this.Wt?.Lk),children:[d6("div",{ref:this.Gya,className:"_5YlOqQ"}),d6("div",{ref:this.Iya,className:"_XCmKw"}),this.JQ.map(b=>b.BKb)]})}componentDidMount(){const b=
p6(()=>[this.props.sheet,this.props.lfa.get(),this.props.pX.get()],([e,f,g],h)=>{[h]=h||[];e!==h&&this.Oqb();this.dUa(f,g)},{fireImmediately:!0}),c=n6(()=>{var e=this.props,f=e.da;e=e.Sh;const g=this.sd.current;if(g){f=f?f.get():1;const {width:h,height:k}=e.get();g.style.width=`${h*f}px`;g.style.height=`${k*f}px`}}),d=this.JQ.map(e=>EHc(e));__c.fc(this,[c,b,...d])}Oqb(){const b=z(this.Gya.current),c=z(this.Iya.current);b.innerHTML="";c.innerHTML="";this.mQa.length=0;this.JQ.length=0}dUa(b,c){const d=
z(this.Gya.current),e=z(this.Iya.current),f=[],g=new Map;for(const h of this.mQa)c.has(h.ka)?g.set(h.ka,h):f.push(h);for(const [h,k]of c)c=g.get(h)||f.pop(),c||(c=new SIc(this.Cia,h),d.appendChild(c.Dha),e.appendChild(c.Eha),this.mQa.push(c)),c.update(k,h,b);for(const h of f)h.hide()}Cia(b,c){const d=this.props.m7,e=this.props.hb,f=this.props.sheet,g=this.props.container,h=this.props.rZ;b=new TIc(this.props.oH,this.props.mj,d(b,c),e,f,b,c,g,h.NKa,this.rla,this.qla);__c.fc(this,EHc(b));this.JQ.push(b);
return b}constructor(...b){super(...b);this.sd=(E6.G(this),Yu());this.Gya=Yu();this.Iya=Yu();this.mQa=[];this.JQ=[];this.rla=x6(c=>{const d=this.props.pX.get();return c==="first"?d.keys().next().value:[...d.keys()].pop()});this.qla=x6(c=>{const d=this.props.lfa.get();return c==="first"?d.keys().next().value:[...d.keys()].pop()})}}({c:[E6,NIc]}=A6(a,[],[oc],OIc))})(),JIc);
var SIc=class{static G(a){L(a,{update:w6})}update(a,b,c){[this.Dha,this.Eha].forEach(d=>{d.style.transform=`translateY(${a}px)`;d.classList.add("FPpqvg")});this.ka=b;for(const [d]of c)c=this.JQ.get(d),c||(c=this.Cia(d,b),this.JQ.set(d,c),this.Dha.appendChild(c.Cha),this.Eha.appendChild(c.aS)),c.update(b)}hide(){[this.Dha,this.Eha].forEach(a=>{a.style.transform="translate(-1000px, -1000px) scale(0)"})}constructor(a,b){this.Cia=a;this.ka=b;this.Dha=(SIc.G(this),document.createElement("div"));this.Eha=
document.createElement("div");this.JQ=new Map}},TIc=class{static G(a){L(a,{ria:v6.ref,ka:v6.ref,update:w6,hz:o6,attrs:o6.struct,cGa:o6,aI:o6,renderer:o6,UWa:o6.struct})}update(a){a!==this.ka&&(this.ka=a,this.OD.ka=a,this.pBa&&this.pBa(),this.pBa=this.NKa(this.ka,this.col,this))}get BKb(){return this.ria}get hz(){const a=this.sheet.layout.cells.get(this.ka,this.col);return a?a.ref:void 0}get attrs(){const a=this.OD.attrs;return{Mh:a?.Mh,textAlign:a?.textAlign,direction:a?.direction,link:a?.link,fontSize:a?.fontSize,
color:a?.color,yE:a?.yE}}get cGa(){var a=this.OD.span;if(!a)return!1;if(a.fc===a.jd&&a.sc===a.ud)return!0;const b=this.rla("first"),c=this.rla("last"),d=this.qla("first"),e=this.qla("last");if(!(b&&c&&d&&e))return!1;const f=this.hb.layout.zj.mh(this.sheet),g=this.hb.layout.zj.$g(this.sheet),h=this.hb.layout.ig.mh(this.sheet),k=this.hb.layout.ig.$g(this.sheet),l=this.hb.Za.K3(a.fc,a.jd,f);a=this.hb.Za.K3(a.sc,a.ud,g);let m;for(const p of l)if(h.has(p)&&f.Ce(p,b)>=0&&f.Ce(p,c)<=0){m=p;break}let n;for(const p of a)if(k.has(p)&&
g.Ce(p,d)>=0&&g.Ce(p,e)<=0){n=p;break}return m===this.ka&&n===this.col}get aI(){const a=this.sheet,b=this.ka,c=this.col;if(!this.container)return{type:void 0,container:{config:a},ka:b,column:c};switch(this.container.type){case "fixed-page":return this.container.DT(c,b);case "sheet-item":return this.container.DT(c,b);case "sheet-element":return this.container.DT(c,b);default:throw new A(this.container);}}get renderer(){const a=this.hz;if(a&&this.cGa&&(a.content.ref||a.Ga.ref))return this.oH({context:{container:this.aI,
attrs:this.attrs},As:this.xIa,mj:this.mj})}get UWa(){this.VWa.reportObserved();var a=OHc(()=>this.renderer);if(a&&(a=a.type==="react"?this.eca:this.iI,a.childNodes.length!==0&&(a=a.childNodes[0],a instanceof HTMLElement)))return{width:a.clientWidth,height:a.clientHeight}}constructor(a,b,c,d,e,f,g,h,k,l,m){this.oH=a;this.OD=c;this.hb=d;this.sheet=e;this.col=f;this.container=h;this.NKa=k;this.rla=l;this.qla=m;this.Cha=(TIc.G(this),document.createElement("div"));this.aS=document.createElement("div");
this.tM=document.createElement("div");this.iI=document.createElement("div");this.eca=document.createElement("div");this.VWa=NHc("content size atom");this.xIa=w6(()=>this.VWa.reportChanged());this.ka=g;this.Cha.className="_2JFriw";this.aS.className="imy9ug";this.tM.className=f6("pDMp7w",{_0yZ6Qg:this.hz?.content.ref?.type!=="text3",qhF5uA:this.hz?.content.ref?.type!=="text3"&&this.hz?.content.ref?.type!=="text2"});this.iI.className="_30B9pw";this.tM.appendChild(this.iI);this.aS.appendChild(this.tM);
this.eca.className="G7zH2w";this.pBa=k(this.ka,this.col,this);this.mj=n=>d6(b,{...n,As:this.xIa})}};var UIc,VIc,WIc,q6;
new (UIc=class extends z6{constructor(){super(q6);VIc()}},(()=>{class a extends(WIc=s6){static G(b){L(b,{Vka:o6})}render(){const {sheet:b,container:c,Sh:d,hb:e,es:f,bw:g,G9:h,oH:k,Of:l,mj:m,viewport:n,KL:p,Vib:q=!1,C9:r,ew:t,a0:v}=this.props,w=b.direction==="ltr"?"TA4X7w":"WvuqMw",x=e.layout.ig.mh(b);if(!e.layout.ig.$g(b).empty&&!x.empty)return d6("div",{className:f6("SNkrHw",w,{RaA0Nw:q}),...l,children:d6(PIc,{oH:k,mj:m,umb:this.Gva,m7:this.m7,hb:e,sheet:b,container:c,Sh:d,es:f,bw:g,G9:h,da:this.da,
viewport:n,KL:p,Vka:this.Vka,C9:r,ew:t,a0:v})})}get Vka(){var b=this.props.sheet,c=this.props.hb;const d={},e=c.layout.zj.h9(b),f=c.layout.zj.g9(b);var g=c.layout.zj.mh(b),h=c.layout.zj.$g(b);b=g.first();c=g.last();const k=h.first(),l=h.last();if(b!=null&&c!=null&&k!=null&&l!=null)return h=f?h.next(f):k,g=e?g.next(e):b,e&&f&&(d.EUa={range:{sc:k,fc:b,ud:f,jd:e}}),e&&h&&(d.ijb={range:{sc:h,fc:b,ud:l,jd:e}}),f&&g&&(d.t2a={range:{sc:k,fc:g,ud:f,jd:c}}),g&&h&&(d.fib={range:{sc:h,fc:g,ud:l,jd:c}}),d}get da(){return this.props.da?
this.props.da:o6(()=>1)}constructor(...b){super(...b);this.Gva=(q6.G(this),h6(c=>{const {sheet:d,Sh:e,hb:f,xFa:g,da:h,eha:k="hidden"}=this.props;return d6(B6,{sheet:d,hb:f,range:c.range,Sh:e,da:h,children:d6(FIc,{...c,sheet:d,hb:f,da:this.da,xFa:g,overflow:k,Sh:e})})}));this.m7=(c,d)=>new __c.KQa(this.props.wm,this.props.hb,this.props.ew,this.props.sheet,c,d,this.da,this.tx,this.wx);this.tx=(c,d)=>this.props.tx?.(this.props.sheet,c,d);this.wx=(c,d)=>this.props.wx?.(this.props.sheet,c,d)}}({c:[q6,
VIc]}=A6(a,[],[oc],WIc))})(),UIc);__c.UQa={IBb:function(a){const b=a.rv,c=a.ne,d=a.ee,e=a.So,f=a.wm,g=a.hb,h=a.ew,k=a.l5;kHc({FD:a.FD,hb:g,Xf:a.Xf,IQb:a.VV,fb:a.fb});const l=GHc({oH:k,hb:g,wm:f,ew:h});b.awa=BHc({lt:l,hb:g});c.Hva=sHc({lt:l});({ymb:a}=zHc({lt:l,Je:e(),Feb:new vIc,hb:g}));d.gp.$va=a;const {pkb:m,qkb:n,okb:p}=rHc({hb:g});return{gSa:h6(q=>d6(THc,{...q,container:void 0,lt:l,xmb:m,zmb:n,vmb:p,mj:UHc}))}}};
}).call(globalThis, globalThis._5f74ec40302898c5a55451c9fbd04240);}

}])
//# sourceMappingURL=sourcemaps/343248e81ad502eb.js.map